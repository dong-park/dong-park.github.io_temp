---
layout: post
title: "클린코드 방법론"
author: "dongpark"
category: study
---

### 클래스와 멤버의 접근 권한을 최소화하라, 접근자 메서드를 사용하라
캡슐화의 기본원칙인 클래스와 멤버의 접근을 가능한 좁혀야한다. 따라서 정보 은닉의 법칙을 따르는게 좋다. 또한 접근권한을 두면서 모듈화가 일어남에 따라 아래와 같은 장점이 생긴다.
- 개발속도
- 성능최적화 용이
- 관리비용의 감소
- 재사용성 증가
- 개발 난이도 하락

자바에서 제공하는 접근자는 총 4가지 성격으로 볼 수 있다. 
- public : 모든 접근을 허용함
- protected : 하위 클래스를 포함한 패키지 내의 접근을 허용함
- package private : 패키지 안에 모든 클래스를 허용함
- private : 톱레벨 클래스에서의 접근을 허용함

`public`,`procted` 는 모듈로 제공시 사용자 차원에서 접근 가능한 인자가 되어버린다. 좋은 사용성을 제공하기 위해서는 서비스 되는한 영원히 지원 되야하는 클래스의 필드가 되어야 한다.
반대로 `package private` 와 `priavte` 레벨에서는 접근이 힘들기 때문에 클래스가 추구하는 추상성만 지킨다면 얼마든지 변경이 가능하다.
또한 모듈로 제공시 클래스의 불변성을 고려해야 하기 때문에라도 인자들은 `private` 속성으로 제공되는게 맞다.
하지만 마냥 좋은것은 아니고 `상위 클래스의 메서드를 하위클래스로 재정의 할때 접근범위가 좁으면 안된다` 는 `리스포크의 치환 법칙` 에 의해 상위 클래스는 무조건 `public` 으로 정의해야 하는점도 맞다

위에서 말하는 불변성의 보장을 지키면 아래와 같은 이점을 본다
- 불변성 보장 O
- 스레드 안전 O

단 추상개념을 완성하는 필드(대게 불변성을 가진 필드들, 키값, 파이값과 같은 값들) `private static final`로 공개해도 좋다. 단 배열은 예외다(배열 생서자의 유동적인 배열 크기에 의해)  

`프로그램 요소의 접근성은 가능한 한 최소한으로 하라. 꼭 필요한 것만 골라 최소한의 public API를 설계하자.
그 외에는 클래스 인터페이스, 멤버가 의도치 않게 API로 공개되는 일이 없도록 해야 한다. 
public 클래스는 상수용 public s tatic final 필드 외에는 어떠한 public 필드도 가져서는 안 된다. 
public static 필드가 참조하는 객체가 불변인지 확인하라`

### 변경 가능성을 최소화하라
변경 가능성을 최소화 하면 아래와 같은 불변의 규칙중 하나이다
- 객체의 상태를 변경하는 메서드를 제공하지 않는다.
- 모든 필드를 final,private 로 선언한다
- 자신외에 가변 컴포넌트에 접근하지 못하도록 한다.

위와 같은 규칙중 하나를 따른다면 스레드로부터 안전하고 자유롭게 공유가 가능해 객체를 만들때 용이하게 참조할 수 있다.
그리고 그 자체로 원자성을 가질수 있어 오류에서 벗어날 수 있다.
값이 다르다면 독립된 객체로 만드는것도 잊지 말아야 한다.

그러고 클래슨느 꼭 필요한 경우가 아니라면 필드를 final 로 두는것이 좋다. 생성자는 불변식 설정이 완료되어 초기화가 완전히 끝난 상태로 객체를 생성시키거나.
정적 팩토리 형태로 객체를 제공하는것도 하나의 방법이다.

### 상속보다는 컴포지션을 사용하라
메서드 호출과 달리 상속은 캡슐화 법칙을 깨드리기 때문에, 상속계획이 있는것이 아니였다면..
포함관계로 개선하거나 변경하고자 하는 클래스를 필드로 선언해 해당 기능들을 정의해 사용하는것이 좋다.

안좋은예 `Stack class`, `Properties class`

### 상속을 고려해 설계하고 문서화하라. 그러지 않았다면 상속을 금지하라
상속용 클래스는 내부적으로 어떻게 쓰는지 문서화 및 검토 및 약속이 진행되어 있어야 한다. 혹은
1. 자신의 개발의도 및 사용패턴을 잘 명기해 두는 방법
2. protected 접근자로 수정의 여부를 제공한다
3. 이도저도 확장성을 고려할게 아니라면 상속을 금지하는편이 좋다

### 추상 클래스보다는 인터페이스를 우선하라
자바에서는 추상클래스가 믹스인을 지원하지 않는다. 
추상클래만으로 복잡한 계층구조를 구현하기엔 어려움이 많아 구현하기 복잡한 클래스의 경우에는 인터페이스를 이용하는게 좋다. 개발하기에 한편 수월하기 때문이다.
다중 구현용 타입으로도 인터페이스가 가장 적합하다.

상속보다는 컴포지션을 사용하라는 곳에서처럼 개발자간 약속이나 개발의도 및 어떻게 사용하는지 명기해놓을수 없으면 인터페이스 사용을 권장하는 바이다.

### 인터페이스는 구현하는 쪽을 생각해 설계하라 
구현이후에 생각할수 있는 불변의 상황이 바뀔수도 있다(무조건 온다고 생각한다). 자바에서는 디폴트 메서드 이전이나 이후에 구현을 지속할수 있도록 장치를 마련해두었다.
인터페이스 설계시 항시 이후에 상황을 대비해 설계해야 한다.

### 인터페이스는 타입을 정의하는 용도로만 사용하라
인터페이스를 상수변수로만 잔뜩 넣은채로 사용하는 방법은 외부에 노출되는 요건때문에 안티패턴으로 규정 짓는다.
특정클래스나 인터페이스에 강하게 연관된 상수라면 인터페이스 자체에 추가해야 한다.

### 태그 달린 클래스보다는 클래스 계층구조를 활용하라
```
Figure Class{
  Shape.(Circle or Rectangle) 이런식의 구현들 
}
```
왜? 루트클래스를 건드리지 않아도 된다 다른 개발자들이 독립적으로 확장할 수 있는 기회를 제공하라

### 멤버 클래스는 되도록 static 으로 만들어라
비정적 멤버클래스, 어댑터화 같은 형태들은 드물게 바깥 인스턴스에서 호출한다. 생성자와 함께 메모리를 점유하는데 안좋은 예이다. 
심한경우 GC가 수집하지 못하는 경우도 있다.
그러니 바깥 인스턴스에 접근할 일이 없으면 무조건 static이 좋다
```
public class MainClass{
}

private static class MemberClass{
}
```

### 톱레벨 클래스는 한 파일에 하나만 담으라
컴파일 과정에 문제가 없는 행동이지만 득도 안되고 위험을 감수해야하는 행동 굳이 여러 클래스를 한 파일안에 두어야 할까?
